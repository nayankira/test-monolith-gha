# This workflow is autogenerated by xCLI and should not be manually edited.
name: Test individual caller

on:
  pull_request:
    branches: [ main ]


run-name: Deploy all enviroments of the service A by @${{ github.actor }}

jobs:
  service-a-dev-deploy:
    name: Deploy Service A Dev
    uses: ./.github/workflows/test-workflows-reusable-deployment.yaml
    with:
      app: "app-a"
      env: "dev"
      version: "123"
    secrets: inherit

  service-a-dev-verification:
    name: verify Service A Dev Deployment
    uses: ./.github/workflows/test-workflows-reusable-verification.yaml
    needs: [service-a-dev-deploy]
    with:
      app: "app-a"
      env: "dev"
      version: "123"
    secrets: inherit

  service-a-np-approval:
    name: Monolith NP approval
    runs-on: ubuntu-22.04
    needs: [service-a-dev-verification]
    steps:
      - name: "approval"
        run: |
          echo "approve np deployment for monolith"

  service-a-np-deploy:
    name: Deploy Service A NP
    needs: [service-a-np-approval]
    uses: ./.github/workflows/test-workflows-reusable-deployment.yaml
    with:
      app: "app-a"
      env: "np"
      version: "123"
    secrets: inherit

  service-a-np-verification:
    name: verify Service A NP Deployment
    uses: ./.github/workflows/test-workflows-reusable-verification.yaml
    needs: [service-a-np-deploy]
    with:
      app: "app-a"
      env: "np"
      version: "123"
    secrets: inherit
